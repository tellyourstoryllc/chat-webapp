@import 'reset.css'
@import 'nib/text/ellipsis'
@import 'nib/overflow'
@import 'nib/vendor'
@import 'defaults'

app-purple = #341B45
app-dark-purple = #2E1C38
app-green = #56C0A5
app-yellow = #E3C634

link-color = #3f9bcd

base-font-family = gotham_rounded, Helvetica, Arial, sans-serif
base-line-height = 20px

warning-text-color = #c09853
warning-background-color = #fcf8e3
warning-border-color = darken(adjust(warning-background-color, 'hue', -10), 3%)

error-text-color       = #b94a48
error-background-color = #f2dede
error-border-color     = darken(adjust(error-background-color, 'hue', -10), 3%)

// Mixins

// Include this mixin to style placeholder text.  Call with a plus prefix to use
// a block.
input-placeholder()
  &.placeholder
    {block}
  &:-moz-placeholder
    {block}
  &::-moz-placeholder
    {block}
  &:-ms-input-placeholder
    {block}
  &::-webkit-input-placeholder
    {block}

grayscale-image()
  filter asseturl('/images/filters.svg#grayscale') // Firefox 3.5+
  filter gray // IE6-9
  -webkit-filter: grayscale(1) // Chrome, Safari 6+, Opera 15+
  filter: grayscale(100%) // Current draft standard.

disable-grayscale-image()
  filter none
  -webkit-filter: grayscale(0)

sprites-background()
  background-image asseturl('/images/sprites2x.png')
  background-size 260px 118px
  background-repeat no-repeat

sprite-icon()
  display inline-block
  background-repeat no-repeat
  vertical-align middle

// Fix flashing on node-webkit.  Add this to any element that may be transformed
// in the future, for example, on hover.
//
// http://viget.com/inspire/webkit-transform-kill-the-flash
webkit-flashing-fix()
  -webkit-transform translateZ(0)

mobile-safari-fixed-position-fix()
  // Use absolute position since fixed is extremely buggy.  Only do this when
  // actually on iOS since it causes other glitches on desktop if used all the
  // time.
  .appleios &
    position absolute

dark-purple-round-input()
  box-sizing border-box
  margin 10px
  padding 6px 8px
  border-radius 15px
  border 1px solid rgba(0,0,0, .5)
  outline none
  box-shadow 0 1px 0 rgba(255,255,255, .18)
  background-color #1E0529
  color rgba(254, 255, 255, 0.65)

  // Placeholder text should match.
  +input-placeholder()
    color rgba(254, 255, 255, 0.65)

dark-purple-scrollbar()
  &::-webkit-scrollbar
    width 10px
  &::-webkit-scrollbar-track
    background-color rgba(0,0,0, 0.5)
    border-radius 10px
  &::-webkit-scrollbar-thumb
    border 1px solid rgba(255,255,255, .3)
    border-radius 10px
    background-color app-dark-purple


///////////////////////////////////////////////////////////
// Animations

.expand-in
  animation-name expand-in
  animation-duration .5s
  animation-timing-function ease-in-out
  visibility visible !important

@keyframes expand-in
  0%
    transform scale(0)
    opacity 0.0
  60%
    transform scale(1.1)
  80%
    transform scale(0.9)
    opacity 1
  100%
    transform scale(1)
    opacity 1

.expand-in-less-bounce
  animation-name expand-in-less-bounce
  animation-duration .5s
  animation-timing-function ease-in-out
  visibility visible !important

@keyframes expand-in-less-bounce
  0%
    transform scale(0)
    opacity 0.0
  60%
    transform scale(1.05)
  80%
    transform scale(0.9)
    opacity 1
  100%
    transform scale(1)
    opacity 1

@keyframes invite-dialog-expand-in
  0%
    transform scale(0.6)
    opacity 0.2
  60%
    transform scale(1.05)
  80%
    transform scale(0.95)
    opacity 1
  100%
    transform scale(1)
    opacity 1

.expand-up
  animation-name expand-up
  animation-duration .3s
  animation-timing-function ease
  visibility visible !important

@keyframes expand-up
  0%
    transform translateY(40%) scale(0.6) scaleY(0.5)
  60%
    transform translateY(-7%) scaleY(1.12)
  75%
    transform translateY(3%)
  100%
    transform translateY(0%) scale(1) scaleY(1)

.expand-down
  animation-name expand-down
  animation-duration .3s
  animation-timing-function ease
  visibility visible !important

@keyframes expand-down
  0%
    transform translateY(-40%) scale(0.6) scaleY(0.5)
  60%
    transform translateY(3%) scaleY(1.04)
  75%
    transform translateY(-3%)
  100%
    transform translateY(0%) scale(1) scaleY(1)

.shake-side-to-side
  animation-name shake-side-to-side
  animation-duration .4s
  animation-timing-function ease
  visibility visible !important

@keyframes shake-side-to-side
  0%
    transform translateX(0%)
  13%
    transform translateX(10%)
  25%
    transform translateX(-10%)
  38%
    transform translateX(8%)
  50%
    transform translateX(-7%)
  63%
    transform translateX(7%)
  75%
    transform translateX(-5%)
  88%
    transform translateX(5%)
  100%
    transform translateX(0%)

///////////////////////////////////////////////////////////
// Fonts

@font-face {
    font-family: 'gotham_rounded';
    src: url('/fonts/gothamrnd-light-webfont.eot');
    src: url('/fonts/gothamrnd-light-webfont.eot?#iefix') format('embedded-opentype'),
         url('/fonts/gothamrnd-light-webfont.woff') format('woff'),
         url('/fonts/gothamrnd-light-webfont.ttf') format('truetype'),
         url('/fonts/gothamrnd-light-webfont.svg#gotham_roundedlight') format('svg');
    font-weight: 100;
    font-style: normal;
}

@font-face {
    font-family: 'gotham_rounded';
    src: url('/fonts/gothamrnd-book-webfont.eot');
    src: url('/fonts/gothamrnd-book-webfont.eot?#iefix') format('embedded-opentype'),
         url('/fonts/gothamrnd-book-webfont.woff') format('woff'),
         url('/fonts/gothamrnd-book-webfont.ttf') format('truetype'),
         url('/fonts/gothamrnd-book-webfont.svg#gotham_roundedbook') format('svg');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'gotham_rounded';
    src: url('/fonts/gothamrnd-medium-webfont.eot');
    src: url('/fonts/gothamrnd-medium-webfont.eot?#iefix') format('embedded-opentype'),
         url('/fonts/gothamrnd-medium-webfont.woff') format('woff'),
         url('/fonts/gothamrnd-medium-webfont.ttf') format('truetype'),
         url('/fonts/gothamrnd-medium-webfont.svg#gotham_roundedmedium') format('svg');
    font-weight: bold;
    font-style: normal;
}

@font-face {
    font-family: 'gotham_rounded';
    src: url('/fonts/gothamrnd-bold-webfont.eot');
    src: url('/fonts/gothamrnd-bold-webfont.eot?#iefix') format('embedded-opentype'),
         url('/fonts/gothamrnd-bold-webfont.woff') format('woff'),
         url('/fonts/gothamrnd-bold-webfont.ttf') format('truetype'),
         url('/fonts/gothamrnd-bold-webfont.svg#gotham_roundedbold') format('svg');
    font-weight: 900;
    font-style: normal;
}

///////////////////////////////////////////////////////////

// All inputs should have a hand cursor.
button, input[type='range'], input[type='checkbox'], label.checkbox, select, input[type='radio']
  cursor pointer

button
  // Fix browser defaults, especially IE9.
  padding-left 6px
  padding-right 6px

input, button, select, textarea
  font-family base-font-family

.pull-left
  float left

.pull-right
  float right

.clearfix
  &:before, &:after
    content ""
    display table
    line-height 0
  &:after
    clear both

.alert
  margin-bottom base-line-height
  border 1px solid warning-border-color
  border-top-left-radius 4px
  border-top-right-radius 4px
  padding 5px 10px
  background-color warning-background-color
  color warning-text-color

.alert-error
  border-color error-border-color
  background-color error-background-color
  color error-text-color

.app-btn
  margin 0
  border 1px solid rgba(0, 0, 20, 0.3)
  padding 10px 17px
  border-radius 6px
  background-color #EEF0F0
  box-shadow inset 0 0 1px rgba(255,255,255, 0.9)
  color hsl(225, 8%, 43%)
  font-size 14px
  text-align center
  text-decoration none
  white-space normal

  &.btn-flat
    border-width 0
    border-radius 2px
    box-shadow none

  &:hover, &.hover
    background-color lighten(#EEF0F0, 50%)

  &:active
    outline 0
    box-shadow inset 0 0 8px rgba(0,0,0, 0.5)

  &.btn-green
    background-color app-green
    color #fff

    &:hover, &.hover
      background-color lighten(app-green, 10%)

  &.btn-fb
    padding 0
    background-color #374F81 // The darker blue behind the icon.
    color #fff

    .btn-fb-text-container
      padding-top 10px
      padding-bottom 10px
      background-color #3C5A99
      margin-left 45px // Space for the facebook-f icon.

    &:hover, &.hover
      background-color lighten(#374F81, 10%)

      .btn-fb-text-container
        background-color lighten(#3C5A99, 10%)

.btn-block
  display block
  box-sizing border-box
  width 100%
  padding-left 0
  padding-right 0

.facebook-f-icon
  float left
  margin-left 16px
  margin-top 6px
  width 12px
  height 22px
  sprites-background()
  sprite-icon()
  background-position -160px -32px


.menu
  position absolute
  box-sizing border-box
  overflow hidden
  background-color #FBFBFB
  color #858C94
  border-radius 4px
  box-shadow 0 0 30px rgba(0,0,0, .25)
  z-index 100
  visibility hidden // Initially hidden.

  font-size 11px
  font-weight bold
  text-transform uppercase

  webkit-flashing-fix()

  .menu-item
    border 1px solid transparent
    border-left-width 0
    border-right-width 0
    padding 10px
    cursor pointer


    &:hover:not(.disabled), &.hover:not(.disabled)
      border-color rgba(44,62,80, .1)
      background-color rgba(44,62,80,.06)

  .separator
    height 0
    border-top 1px solid rgba(44,62,80, .1)

.disabled, .app-btn[disabled]
  opacity .6
  cursor inherit

.room-avatar
  position relative
  display inline-block
  box-sizing border-box
  width 42px
  height 42px
  border 4px solid hsla(180, 6%, 94%, 0.5)
  border-radius 50%
  background-clip padding-box
  vertical-align middle
  background-clip padding-box
  background-repeat no-repeat
  background-position center
  background-size cover

  &.group
    border-width 0

  &.not-displayed
    display none

  &.avatars-off:not(.always-show-avatar), &.blank-avatar
    width 11px
    height 11px
    background-image none !important
    margin-top 2px

  &.available, &.away, &.idle, &.do_not_disturb, &.unavailable
    transition border-color .5s ease-out

  &.available
    border-color app-green

  &.away, &.idle
    border-color app-yellow

  &.do_not_disturb
    border-color #DA362A

  &.unavailable
    border-color hsla(0, 0%, 73%, 0.5)

  &.no-status
    border-color transparent

  &.phone:after, &.tablet:after
    position absolute
    right -5px
    bottom -5px
    content ''
    width 12px
    height 22px
    sprites-background()
    background-position -88px -4px

.medium-avatar-image
  width 43px
  height 43px
  border-radius 50%

.emoticon
  height 32px
  width auto
  vertical-align middle

.small-emoticon
  height 20px

.page-overlay
  width 100%
  height 100%
  position fixed
  top 0
  left 0
  background-color rgba(0,0,0, .75)
  z-index 1000

  transition opacity 0.2s ease-out, visibility 0.2s ease-out

  &.hidden
    visibility hidden
    opacity 0

.members-preview-subtitle
  margin-bottom 10px
  font-size 12px
  font-weight bold

.members-preview
  font-size 12px

  .member-preview:not(.name-horizontal)
    float left
    margin-right 5px
    margin-bottom 15px
    width 68px
    text-align center

    // Set height so long names overflow show up to 2 lines, but no more.
    height 67px
    overflow hidden

  .no-one-here, .member-count-more
    color rgba(0,0,0, .4)
    font-weight bold
    text-shadow 0 1px 0 #fff

  .member-count-ellipsis
    sprites-background()
    sprite-icon()
    display block
    width 32px
    height 10px
    background-position -180px -41px
    margin-left 10px
    margin-bottom 3px
    opacity .4

  .member-count-more
    float left
    padding-top 17px

  .no-one-here
    margin 20px

.modal
  position fixed
  top 50%
  left 50%
  overflow hidden
  z-index 1001 // Higher than .page-overlay
  border-radius 6px
  background-color #EDEDED
  box-shadow 0 0 40px rgba(0,0,0, 1)

settings-dialog-width = 380px
.settings-dialog
  box-sizing border-box
  width settings-dialog-width
  margin-left -(settings-dialog-width / 2)
  margin-top -185px // Negative height divided by 2.
  visibility hidden // Initially hidden.

  .settings-table
    width 100%
    margin-bottom 10px

  .header
    padding 10px
    border-bottom 1px solid #B7B7B7
    background-color #E3E3E3
    text-shadow 0 1px 0 #fff
    font-weight bold

    .close
      float right
      // Make it a bigger target for touch interfaces.
      padding 5px 10px
      margin -5px -5px 0 0

      cursor pointer

  .content
    padding 10px
    font-size 12px

  .tab-handles
    margin-bottom 10px
    padding-left 5px
    border-bottom 1px solid #999

  .tab-handle
    display inline-block
    margin-bottom -1px
    padding 5px 10px
    border-radius top 6px
    border 1px solid #999
    color #666
    font-size 14px
    cursor pointer

    &:hover
      background-color #fff

    &.active
      color #000
      border-bottom-color #EDEDED
      box-shadow inset 1px 1px 0 rgba(255,255,255, 1)

  .subtitle
    margin-bottom 5px
    font-size 13px
    text-shadow 0 1px 0 #fff
    font-weight bold

  .label-cell, .control-cell
    padding-bottom 5px
    vertical-align top

  .label-cell
    padding-right 5px
    text-align right

  .help-tip
    color rgba(0,0,0, .5)
    text-align left

  .editable-label-cell, .editable-display
    padding-top 5px

  .editable-display
    transition opacity 0.2s ease-out

    &.hidden
      opacity .2

  .profile-first-column
    width 85px

  .account-first-column
    width 65px

  .checkbox-control-cell
    text-align center

  .image-label-cell
    vertical-align middle

  .avatar-image
    width auto
    height 20px
    vertical-align middle

  .wallpaper-thumbnail-image
    width 45px
    height auto
    max-height 90px
    vertical-align middle

  .volume-label-cell
    padding-top 7px

  .notification-volume
    vertical-align middle

    // IE sizes range inputs differently than webkit.  It adds padding and has a
    // much wider width.
    min-height 15px
    max-width 130px
    margin 2px 3px
    padding 5px 0

  .max-volume-icon
    sprites-background()
    sprite-icon()
    width 16px
    height 16px
    background-position -26px -38px

  .alert
    // Reduce bottom margin of validation errors.
    margin-bottom 5px

  .email-input
    width 160px

  .email
    display inline-block
    max-width 190px
    overflow ellipsis

  .email-actions
    white-space nowrap

// Stylus doesn't support arbitrary expressions in media queries.
//
// http://stackoverflow.com/questions/13060726/variables-in-stylus-css-media-queries
mobile-settings-dialog-media-query = "(max-width: " + settings-dialog-width + ")"
@media mobile-settings-dialog-media-query
  .settings-dialog
    // On narrow mobile devices, use the full screen width and center.
    width 100%
    left 0
    margin-left 0

@media (max-height: 440px)
  .settings-dialog
    // On short mobile devices, use the full screen height and allow scrolling.
    height 100%
    top 0
    margin-top 0
    overflow auto


html
  min-height 100%

body
  background-color #E4E7E8
  font-family base-font-family
  overflow hidden

a
  color link-color

input, textarea
  font-family gotham_rounded, Helvetica, Arial, sans-serif


room-sidebar-width = 240px

.navbar
  display none // Initially invisible.
  position fixed
  box-sizing border-box
  width room-sidebar-width
  min-height 52px
  border-top 4px solid #26BE9D
  padding 10px 10px
  background-color app-purple

  .right-nav-links
    float right
    text-align right

  a
    color #fff
    text-decoration none

  .nav-link
    display inline-block
    border 2px solid #fff
    border-radius 3px
    padding 10px 25px

    &:hover
      background-color rgba(255,255,255, 0.1)

  .signup-nav-link
    margin-left 20px
    border-color #56C0A5
    background-color #56C0A5

    &:hover
      background-color lighten(#56C0A5, 10%)

.brand
  margin-right 10px
  text-align center

  > a
    color #fff

// Up to landscape phone.
@media (max-width: 480px)
  .brand
    margin-bottom 10px

// body
.logged-out, .join-page
  background-color #E4E6E8
  overflow auto

  .navbar
    display block
    position static
    width auto

  .navbar-centered-content
    // Don't stretch out to the corners of the window.
    max-width 960px
    margin-left auto
    margin-right auto

  .brand
    float left

  #brand-image-wide
    display block

// body
.join-page
  background-image asseturl('/images/purple-bkg.png')
  background-size cover
  color rgba(255,255,255, .5)

  .navbar
    display none

  .logo-container
    border-top 4px solid app-green
    padding-top 10px
    text-align center

  .footer
    margin-bottom 10px

    a
      color rgba(255,255,255, .5)

// This is for static pages on mobile like TOS and help.
// body
.static-mobile-layout
  margin 10px

  .page-content
    margin-left auto
    margin-right auto
    max-width 800px

.footer
  margin-top 20px
  font-size 11px
  text-align center

  &.fixed-to-bottom
    position fixed
    bottom 0
    width 100%
    padding 10px

  .app-links
    margin-bottom 10px

  .footer-link
    margin-right 10px
    text-decoration none

    &:hover
      text-decoration underline

.empty-content-page
  text-align center
  margin 20px

@media (max-width: 480px)
  .empty-content-page
    margin-left 10px
    margin-right 10px

.error-page
  .error-title
    margin 20px

  .error-message
    margin 10px
    color #888
    font-size 14px

.form
  border 1px solid #ccc
  border-radius 4px
  padding 10px
  background-color #F8F8F8
  font-size 14px

  .title
    margin-bottom 20px

  input[type=text], input[type=email], input[type=password]
    box-sizing border-box
    width 100%
    margin 0
    border 1px solid #D4D4D4
    padding 6px 11px
    font-size 14px

  .control-group
    margin-bottom 10px

  .form-actions
    text-align right

  .related-link
    float left
    clear left
    color #aaa
    font-size 11px
    text-align left

.signup-form, .login-form
  margin-left auto
  margin-right auto
  padding 20px

  .title
    text-align center

  .facebook-divider
    margin 20px 0 5px 0

  .facebook-or
    margin-bottom 20px

.login-form
  width 214px
  margin-top 20px
  margin-bottom 20px

  .close
    float right
    padding 5px
    color #000
    text-decoration none
    opacity .5

    &:hover
      opacity 1

  .facebook-group
    text-align center

.signup-form
  width 214px
  margin-top 20px
  margin-bottom 20px

  .close
    float right
    color #000
    text-decoration none
    opacity .5

    &:hover
      opacity 1

  .related-link
    font-size 9px

  .facebook-group
    text-align center

.forgot-password-form
  width 280px
  margin 20px auto

  input[type=text], input[type=email], input[type=password]
    width 254px

.password-reset-form
  width 214px
  margin 20px auto

.join-members-content
  .room-title
    padding 20px
    background-color #E2E3E3

  .dialog-content
    padding 20px
    font-size 12px

  .dialog-actions
    text-align center

  .avatar
    float left
    margin-right 5px

  .room-name-info-container
    margin-top 5px
    margin-left 50px
    text-align left

  .room-topic
    margin-top 5px
    max-width 330px  // Determined experimentally.
    font-size 12px

  .signup-or-login
    margin 20px

    .title
      margin-bottom 10px

  .join-button
    margin 20px
    font-size 16px

  .cancel-link
    color #aaa
    font-size 12px
    text-decoration none

    &:hover
      text-decoration underline

.room-key-form-component
  .room-key-form
    position relative
    margin-left 10px
    color rgba(255,255,255, .6)

  .room-key-input
    dark-purple-round-input()

    width 180px
    margin 0
    padding 10px 38px
    border-radius 25px
    font-size 12px
    text-align center

  .room-key-icon
    position absolute
    top 8px
    left 50%
    margin-left -85px

    sprites-background()
    sprite-icon()
    background-position -133px -32px
    width 23px
    height 23px

    opacity .7

  .submit-room-key-button
    position absolute
    top 6px
    right 50%
    margin-right -84px
    width 25px
    height 25px
    border-radius 20px
    background-color app-green
    cursor pointer
    text-align center

  .submit-room-key-icon
    sprites-background()
    sprite-icon()
    background-position -121px -9px
    width 20px
    height 20px
    margin-left 3px
    margin-top 4px

// Home page

.home-page
  background-color app-dark-purple
  background-image asseturl('/images/purple-bkg.png')
  background-size cover
  color #fff
  text-align left

  .navbar
    padding 30px
    background-color transparent

  .home-content, .text-row-content
    max-width 960px
    margin 0 auto

  .home-content
    position relative // For .screenshot.
    padding-bottom 184px

  .title
    margin 25px 0 30px
    max-width 450px
    font-size 40px
    font-weight 300
    line-height 120%

    strong
      font-weight normal

  .home-download-area
    width 250px
    text-align center

    .app-btn
      margin-bottom 10px
      padding-top 14px
      padding-bottom 14px
      border-radius 4px
      font-size 24px
      font-weight bold

    .signup-link
      color rgba(255,250,255, .4)
      font-size 12px
      text-decoration none

      &:hover
        color rgba(255,240,255, .6)
        text-decoration underline

  .room-key-form-component
    display inline-block

  .screenshot
    position absolute
    right 0
    bottom 0
    width 98% // Leave some margin on small displays.
    height auto
    vertical-align middle

  .text-row
    padding 50px 100px
    text-align left

    &.light-row
      background-color #fff

    &.dark-row
      background-color #EDF0F1
      border 1px solid rgba(213,215,215, .7)
      border-left-width 0
      border-right-width 0

    h3
      margin-bottom 15px
      color #384657
      font-size 27px
      font-weight bold

    p
      max-width 854px
      color #5c7987
      line-height 28px
      font-size 18px

  .big-image
    &.pull-left
      float left
      margin-right 80px
    &.pull-right
      float right
      margin-left 80px

  .footer
    margin-top 0
    border-top 1px solid rgba(213,215,215, .7)
    padding 40px
    background-color #EDF0F1
    color #5c7987
    font-size 12px

    .footer-link
      color #5B7887

@media (max-width: 867px)
  .home-page
    // At this width there isn't enough room for the screenshot to the right, so
    // move it below.
    .home-content
      margin 0 auto
      padding-bottom 0
      text-align center
    .title
      margin-left auto
      margin-right auto
      text-align center
    .home-download-area
      width 98%
      max-width 250px
      margin 10px auto

    .screenshot
      position static
      margin 10px 0 0 0

@media (max-width: 480px)
  .room-key-form-component
    margin-top 10px

  .home-page
    .text-row
      padding-left 20px
      padding-right 20px

      h3
        padding-top 0 !important

    // Center images on their own line.
    .big-image
      display block
      margin 0 auto 10px !important
      float none !important

.desktop-home-page
  .navbar
    display none

  .desktop-home-content
    max-width 960px
    margin 30px auto 0
    text-align center

    .brand-image-wide
      display inline-block
      margin-bottom 50px

    .app-btn
      display inline-block
      box-sizing border-box
      width 250px
      margin-bottom 30px
      padding 12px 20px
      font-size 18px
      line-height 1.2

      &.first
        margin-right 10px

    .room-key-form-component
      display block

  .footer
    margin-top 10px
    margin-bottom 10px
    border 0
    background-color transparent
    color rgba(255,255,255, .3)

    .footer-link
      color rgba(255,255,255, .3)


home-modal-width = 350px
home-modal-horiz-padding = 30px
home-modal-inner-width = home-modal-width - 2 * home-modal-horiz-padding

.home-signup-modal
  width home-modal-width
  height 167px // No room, no email form.
  margin-left -(home-modal-width / 2)
  margin-top -83px
  color #5B6271

  transition-duration 0.1s
  transition-timing-function ease-out
  transition-property height, margin-top

  .loading
    display none
    margin 20px
    text-align center

    &.visible
      display block

  .content-container.hidden
    display none

  .close
    float right
    padding 5px 10px
    color rgba(0,0,0, 0.4)
    text-decoration none

    &:hover
      color rgba(0,0,0, 0.8)

  .room-title
    padding 20px
    background-color #E2E3E3

  .dialog-content
    padding home-modal-horiz-padding
    font-size 12px

  &.is-showing-email-form
    height 250px

    &.has-error
      height 305px

  &.with-room
    height 441px
    margin-top -220px

    &.is-showing-email-form
      height 410px

    .dialog-content
      // Reduce top padding with there's a room title.
      padding-top 10px

  .avatar
    float left
    margin-right 5px

  .room-name-info-container
    margin-top 5px
    margin-left 50px
    text-align left

  .room-name, .members-preview-subtitle
    font-weight bold

  .room-topic
    margin-top 5px
    width 260px  // Determined experimentally.
    overflow ellipsis
    font-size 12px

  .members-preview
    // Undo the right-most .member-preview.
    margin-right -5px

  .members-preview-subtitle
    margin-bottom 10px

  .signup-auth-choice
    position absolute
    left 30px // .dialog-content padding-left.
    width home-modal-inner-width

    transition-duration 0.2s
    transition-timing-function ease-out
    transition-property left, visibility

    &.hidden
      visibility hidden !important
      left -100%

  .or-divider
    text-align center

  &.with-room
    .signup-auth-choice
      bottom 30px // .dialog-content padding-bottom.

  .login-hint
    margin-top 10px
    color rgba(0,0,0, 0.5)
    font-size 10px
    text-align center

  .terms
    margin-top 10px
    color rgba(0,0,0, 0.5)
    font-size 10px
    text-align center

    > a
      color rgba(0,0,0, 0.5)
      text-decoration none

      &:hover
        text-decoration underline

  .or-divider
    margin 10px

  .signup-with-facebook-button
    margin-bottom 10px

  .signup-form-component
    position absolute
    left 100%
    bottom 30px // .dialog-content padding-bottom.
    visibility hidden // Initially invisible.

    transition-duration 0.2s
    transition-timing-function ease-out
    transition-property left, visibility

    &.visible
      visibility inherit
      left 30px

  .home-signup-form
    width home-modal-inner-width
    margin 0
    border-width 0
    padding 0
    background-color transparent
    text-align center

    input[type=text], input[type=password], input[type=email]
      box-sizing border-box
      width 100%
      text-align center

    .alert
      max-height 55px
      overflow hidden

      // Possibly displaying on top of member previews.
      box-shadow 0 0 30px rgba(0,0,0,.6)

      position relative
      top 5px
      opacity 0

      transition-duration 0.2s
      transition-timing-function ease-out
      transition-property opacity, top

      &.visible
        top 0
        opacity 1

      .close
        float right
        padding 0 8px
        cursor pointer

  // Facebook button has its own padding thing.
  .app-btn:not(.btn-fb)
    padding-top 10px
    padding-bottom 10px

  .after-actions-link
    margin-top 10px
    text-align left
    font-size 10px

  .back-link
    color rgba(0,0,0, 0.5)
    cursor pointer


.join-page-content
  margin 10px auto 50px
  max-width 800px
  text-align center

  .alert
    margin-top 10px

  .text-content
    margin 20px auto

///////////////////////////////////////////////////////////
// Mobile Install

// body
.with-mobile-dialog
  // Need to put the background here, otherwise on tall displays, the .mobile-
  // install-dialog does not fill the height.
  background-color app-purple
  background-image asseturl('/images/purple-bkg.png')
  background-size cover

  .navbar
    display none !important

// Note: Can't just used fixed position div with high z-index since it's broken
// on iOS mobile Safari.
.mobile-install-dialog
  box-sizing border-box
  width 100%
  min-height 100%

  border-top 6px solid app-green
  padding 15px
  color rgba(255,255,255, 0.8)
  text-align center

  .title
    margin 0 auto 50px

  .to-enter
    font-size 20px
    line-height 26px

    &.no-join-code
      margin-bottom 15px

  .join-code
    margin-top 15px
    margin-bottom 15px
    color rgba(255,255,255, 0.95)
    font-size 30px
    font-weight bold

  .app-btn
    padding-top 15px
    padding-bottom 15px
    font-size 20px

  .app-btn:not(.btn-green)
    color rgba(0,0,0, .8)

  .btn-block
    margin-bottom 10px
    // On iPad, don't stretch the buttons too wide.  Center them.
    max-width 300px
    margin-left auto
    margin-right auto

  .already-text
    margin-bottom 10px
    font-size 12px

  .subtle-link
    color rgba(255,255,255, 0.8)
    font-size 12px

  .hidden-continue
    position fixed
    left 0
    bottom 10px
    width 20px
    height 20px

@keyframes repeated-pointing
  from
    top 25px
  to
    top 5px

.chrome-permission-bar-callout
  position absolute
  top 0
  left 0
  z-index 10000

  background-color rgba(0,0,0, 0.85)
  color #fff
  font-size 20px
  line-height 1.2
  text-align center

  // Initially hidden.
  visibility hidden
  opacity 0

  transition-duration .2s
  transition-timing-function ease-out
  transition-property opacity, visibility

  &.visible
    transition-duration .5s
    visibility visible
    opacity 1

  .subtext
    font-size 12px
    color rgba(255,255,255, .5)

  .chrome-permission-arrow
    sprites-background()
    sprite-icon()
    background-position -77px -58px

    position absolute
    top 5px
    right 50px
    width 18px
    height 52px

    animation repeated-pointing 1s ease-in-out infinite alternate

///////////////////////////////////////////////////////////

.app-install-banner
  position absolute
  top 0
  left 0
  box-sizing border-box
  width 100%
  z-index 100
  padding 5px
  border-bottom 1px solid rgba(0,0,0, .8)
  box-shadow 0 5px 15px rgba(0,0,0, .6)
  background-color app-purple
  color #F8F8F8
  font-size 12px
  line-height 1.2

  opacity .95

  transition-duration 0.2s
  transition-timing-function ease-out
  transition-property opacity, top, visibility

  &.temporarily-hidden
    top -100px // At least the height of the banner.

  &.hidden
    visibility hidden
    opacity 0

  .close
    float left
    padding 10px
    cursor pointer
    opacity .6

    &:hover
      opacity 1

  .app-install-logo
    float left

  .for-platform
    vertical-align middle

  a.launch-app-link
    color rgba(255,255,255, 0.7)

    &:hover
      color #F8F8F8


.rooms-sidebar
  position fixed
  top 0
  box-sizing border-box
  width room-sidebar-width
  height 100%
  border-top 3px solid app-green
  background-color app-purple
  background-image asseturl('/images/purple-bkg.png')
  background-repeat no-repeat
  background-size cover

  mobile-safari-fixed-position-fix()

  .logo
    margin-top 10px
    text-align center

.left-sidebar-tabs-container

  .left-sidebar-tab-handles
    border-bottom 1px solid rgba(0,0,0, .5)
  
  .tab-handle
    display inline-block
    margin 5px 0 -1px 5px
    border 1px solid rgba(0,0,0, .5)
    border-top-left-radius 3px
    border-top-right-radius 3px
    padding 10px
    color rgba(255,255,255, 0.6)
    font-size 12px
    line-height 1
    cursor pointer
    box-shadow inset 0 -5px 10px rgba(0,0,0, .3)

    &.active
      color rgba(255,255,255, 0.8)
      border-bottom-color app-purple
      box-shadow 0 -2px 2px rgba(0,0,0, .2), inset 0 0px 5px hsl(276, 44%, 28%)

    &:hover
      color rgba(255,255,255, 0.9)

.tab-content.hidden
  display none !important

.join-text-container, .contacts-search-container
  position relative

  .join-text-submit
    width 12px
    height 12px
    opacity .4
    // Center vertically.
    position absolute
    top 0
    bottom 0
    right 15px
    margin auto

    padding 7px 5px
    cursor pointer

    &:hover
      opacity .6

  .join-text-submit-icon
    sprites-background()
    sprite-icon()
    width 12px
    height 12px
    background-position -123px -11px
    position relative
    top -4px

  .join-text, .contacts-search-text
    dark-purple-round-input()
    width room-sidebar-width - 2*10px
    padding 6px 21px 6px 11px

.rooms-list, .contacts-list
  .room-avatar.unavailable
    // Unavailable color on purple background, but fully opaque so it works in
    // the Mac app and Safari.
    border-color #776A7F

.rooms-list
  box-sizing border-box
  width room-sidebar-width - 2px // Leave pixels to the right for the scrollbar margin.
  overflow auto // Scrollable.

  // Scrollbars.
  dark-purple-scrollbar()

.room-list-item
  position relative

  > a
    display block
    overflow hidden

    border-top 1px solid transparent
    border-bottom 1px solid transparent
    padding 10px
    color rgba(254, 255, 255, 0.65)
    text-decoration none

    .active-indicator
      position absolute
      left 0
      top 0
      width 4px
      height 100%
      background-color app-green

      // Get the height to not cover the container's borders.
      border 1px solid transparent
      background-clip padding-box
      box-sizing border-box
      border-left-width 0
      border-right-width 0

      // Initially invisible.
      visibility hidden
      opacity 0

      transition-duration 0.2s
      transition-property opacity, visibility

    &:hover
      color #ccc

    &.active
      background-color #3E274D
      color #eee
      border-top-color #2E1C3A
      border-bottom-color #2E1C3A
      box-shadow inset 0 0 1px rgba(255,255,255, 0.2)

      .active-indicator
        visibility visible
        opacity 1

  &.unread

    > a
      color #FD7773

  .create-room-icon
    sprites-background()
    sprite-icon()
    width 26px
    height 26px
    background-position -2px -5px
    margin-left 9px

  .room-avatar, .create-room-icon
    float left

  .room-name, .room-status
    margin-left 50px
    // Subtract room avatar width, margins, and room icon width.
    width room-sidebar-width - 50px - 50px
    overflow ellipsis
    line-height 1.2 // Since overflow is hidden, don't cut off descenders.

  .room-name
    margin-top 5px
    font-size 14px
    line-height 16px

  .create-room-name
    margin-top 6px

  .room-status
    margin-top 5px
    color rgba(254, 255, 255, 0.45)
    font-size 12px

  &.avatars-off
    .room-name, .room-status
      margin-left 20px

    .room-name
      margin-top 0

  .room-door-icon
    // Center vertically.
    position absolute
    top 0
    bottom 0
    margin auto

    right 7px
    sprites-background()
    sprite-icon()
    width 18px
    height 20px
    background-position -115px -34px
    opacity .9

    &.hidden
      display none

  .room-icon.status-icon, .room-avatar
    margin-right 5px

.current-user-status-bar
  position fixed
  display table
  left 0
  bottom 0
  box-sizing border-box
  width room-sidebar-width
  // Determined experimentally.  Prevents us from needing to resize the left
  // sidebar when turning on and off the display of avatars.
  height 58px

  border-top 1px solid #42314C
  background-color app-dark-purple
  color #aaa

  mobile-safari-fixed-position-fix()

.current-user-status-cell
  display table-cell
  border-right 1px solid #34223F
  padding 8px 10px
  cursor pointer // Clickable.

  &:hover
    color #ccc

  // Need this extra nesting since Firefox can't do position relative on a
  // table-cell.
  .current-user-status
    position relative

    &:after
      // Center vertically.
      position absolute
      margin auto
      right -7px
      top 0
      bottom 0

      content: ''
      width 12px
      height 5px
      sprites-background()
      background-position -107px -15px
      opacity .6

    .room-avatar
      float left

  &:hover .current-user-status:after
    opacity 1

  .username, .status-text
    margin-left 50px
    max-width room-sidebar-width - 120px // Subtract the width of the avatar and settings.
    overflow ellipsis
    font-size 12px
    line-height 1.2

  .username
    padding-top 8px

  .status-text
    margin-top 5px
    color rgba(254, 255, 255, 0.45)

  &.avatars-off
    .username, .status-text
      margin-left 20px

    .username
      padding-top 0

.choose-status-menu
  position fixed
  left 5px
  bottom 57px
  width room-sidebar-width + 50px
  visibility hidden // Initially hidden.

  mobile-safari-fixed-position-fix()

  .room-avatar
    margin-top 0
    margin-bottom 1px

.status-text-menu
  position fixed
  left 5px
  bottom 85px
  width room-sidebar-width + 50px
  animation-duration .4s
  text-transform none

  mobile-safari-fixed-position-fix()

  > .menu-item
    cursor default

  .new-status-text
    box-sizing border-box
    width room-sidebar-width - 20px
    float left

  .save-status-text-button
    float right
    margin 4px 0 0 0

.settings-icon-cell
  display table-cell
  width 18px
  padding 8px 10px
  text-align right
  vertical-align middle
  cursor pointer

  &:hover > .settings-icon
    opacity 1
    transform rotate(180deg)

.settings-icon
  sprite-icon()
  width 18px
  height 20px
  sprites-background()
  background-position -235px -8px

  opacity .6
  transition transform .2s ease-in-out

  webkit-flashing-fix()

.contact-actions-menu
  left room-sidebar-width - 13px // Don't align with scrollbars when present.

  transition top 0.1s ease-out

.contacts-list
  color rgba(254, 255, 255, 0.65)
  font-size 14px
  line-height 1.2
  overflow-y auto

  dark-purple-scrollbar()

  .loading, .none-found
    padding 10px
    font-size 12px

.contact-list-item
  position relative

  > a
    display block
    padding 5px 10px
    color rgba(254, 255, 255, 0.65)
    text-decoration none

    &:hover
      color #ccc

  &.active
    > a
      background-color #3E274D
      color #eee
      border-top-color #2E1C3A
      border-bottom-color #2E1C3A
      box-shadow inset 0 0 1px rgba(255,255,255, 0.2)

  &.add-contacts-list-item
    margin-top 5px
    padding-top 10px
    padding-bottom 10px
    cursor pointer

    &:hover
      color #ccc

  .add-contacts-icon
    sprites-background()
    sprite-icon()
    width 32px
    height 28px
    background-position -39px -59px
    margin-left 9px

  .room-avatar, .add-contacts-icon
    float left

  .room-avatar
    width 26px
    height 26px
    border-width 3px

    &.avatars-off
      margin-top 6px

  .username
    max-width room-sidebar-width - 50px - 35px
    overflow ellipsis
    margin-left 34px // Avatar width.
    margin-top 5px
    margin-bottom 5px

  .add-contacts-name
    margin-top 7px
    margin-left 50px // Icon width.

  // .contact-menu-arrow-icon
  //   display none
  //   position absolute
  //   right 14px
  //   width 0
  //   height 0

  //   // Right arrow.
  //   border 6px solid rgba(255,255,255, .8)
  //   border-top-color transparent
  //   border-bottom-color transparent
  //   border-right-width 0

  //   // Center vertically.
  //   margin auto
  //   top 0
  //   bottom 0

  // &:hover:not(.active)
  //   .contact-menu-arrow-icon
  //     display block

room-content-margin-width = 10px
room-content-margin-height = 10px

.room-content
  position absolute
  top 0
  left room-sidebar-width
  box-sizing border-box
  height 100%
  border room-content-margin-width solid transparent
  border-top-width room-content-margin-height
  border-bottom-width room-content-margin-height
  background-color #e4e7e8

  transition left .2s ease-out

  &.lobby
    // In the lobby, we show callouts that overflow.
    overflow visible

.toggle-sidebar-tab
  display none

// At very narrow width, hide most of the rooms sidebar.
//
// If you change these dimensions, you should also change
// `App.RoomsContainerComponent::messagesWidth()`
@media (max-width: 515px)

  .room-content:not(.out-of-the-way)
    left 0

  .toggle-sidebar-tab
    position fixed
    top 5px
    left 5px
    display block
    padding 8px 8px 16px
    cursor pointer

    mobile-safari-fixed-position-fix()

  .toggle-sidebar-icon
    width 16px
    height 12px
    sprites-background()
    sprite-icon()
    background-position -69px -41px

.modal-form
  margin 20px auto
  padding 10px

  .close
    float right
    // Make it a bigger target for touch interfaces.
    padding 5px 10px
    margin -5px -5px 0 0

    cursor pointer

  .title
    margin-bottom 20px

  input[type=text]
    font-size 14px

  .control-group
    margin-bottom 10px

  .form-actions
    text-align right

.create-room-form
  dialog-width = 365px
  width dialog-width
  margin-left -182px // Negative width divided by 2.
  margin-top -144px // Negative height divided by 2.
  overflow visible // So that autocomplete suggestions show.

  .group-title
    margin-top 20px
    margin-bottom 10px

  .add-members-list
    max-height 67px
    overflow-y auto
    border 1px solid #d4d4d4
    background-color #fff

    &.hidden
      display none

  .add-members-list-item
    margin-top 3px
    margin-bottom 3px
    max-width 95%
    overflow ellipsis
    line-height 1.2

  .remove
    padding 0 3px
    color #aaa
    cursor pointer

    &:hover
      color #444

  input[type=text]
    padding-top 9px
    padding-bottom 9px

  button-width = 132px
  .add-text-container
    float left
    width 100%
    margin-right -(button-width)

  .create-room-add-text
    width (dialog-width - button-width - 11px) !important
    margin-right button-width + 11px !important

  .add-member-button
    float left
    width button-width

  .form-actions
    margin-top 20px

add-contacts-form-width = 355px
.add-contacts-form
  box-sizing border-box
  width add-contacts-form-width
  max-width 100%
  margin-left -(add-contacts-form-width / 2)
  margin-top -82px // Negative height divided by 2.

  .text-width-fix
    padding-right 2 * (1px + 5px) // Twice textarea border and padding.

  .new-contacts-text
    box-sizing content-box
    width 100%
    height 3.5em
    margin 0
    border-radius 3px
    padding 5px
    font-size 12px
    line-height 1.2

  .help-text
    margin 5px 0
    color #888
    font-size 80%

add-contacts-form-width-media = "(max-width: " + add-contacts-form-width + ")"
@media add-contacts-form-width-media
  .add-contacts-form
    left 0
    margin-left 0

room-members-sidebar-width = 200px

.room-menu
  position absolute
  right 4px
  top 51px
  width room-members-sidebar-width - 10px

.invite-dialog
  position absolute
  right 7px
  top 40px
  z-index 10

  width room-members-sidebar-width + 65px

  border 1px solid rgba(0,0,0, .5)
  border-radius 4px
  padding 20px
  background-color #FBFBFB
  box-shadow 0 0 30px rgba(0,0,0, .8)
  text-align center

  // Initially invisible.
  visibility hidden
  opacity 0

  // Animation for hiding.
  transition opacity .1s ease-out, visibility .1s ease-out, transform .1s ease-out

  &.invite-dialog-animate-in
    transition none // Turn off hiding transition.
    animation-name invite-dialog-expand-in
    animation-duration .3s
    animation-timing-function ease-in-out
    animation-fill-mode forwards
    visibility visible
    opacity 1
    transform scale(1)

  &.over-messages
    right auto
    top 71px

  .close
    float right
    margin -20px -20px 0 0
    padding 5px 5px
    cursor pointer
    color rgba(0,0,0, .4)

    &:hover
      color rgba(0,0,0, .8)

  .instructions
    margin-bottom 10px
    font-size 12px

  .alert
    margin-bottom 10px
    font-size 12px
    line-height 1.2

    transition-duration .2s
    transition-property opacity, visibility, margin

    &.hidden
      visibility hidden
      opacity 0
      margin 0

  .add-text
    box-sizing border-box
    width 185px
    margin 0 5px 5px 0
    padding 8px 6px
    font-size 14px
    line-height normal
    text-align left

    transition background-color .2s

    &.with-user-selection
      background-color warning-background-color

// This is for the component.
.user-autocomplete
  text-align left

// This is the invite dialog's add user instance of the component.
.add-user-autocomplete
  .autocomplete-item
    max-width room-members-sidebar-width + 65px
    overflow ellipsis

.room-members-sidebar
  position absolute
  box-sizing border-box
  width room-members-sidebar-width
  overflow hidden
  border-left 1px solid #C2C7CB
  border-bottom-right-radius 6px
  background-color #EEF0F0
  font-size 12px
  line-height 1.2em

  &.hidden
    display none !important

  .one-to-one-specific, .room-specific
    &.hidden
      display none

  .one-to-one-specific
    .username
      box-sizing border-box
      width 100%
      max-width none !important // Override rules below.
      padding 10px
      text-align center
    .room-avatar.blank-avatar
      margin-top 1px
    .user-status
      padding 10px
    .idle-duration
      vertical-align baseline
    .status-text
      margin 0 10px 10px
    .status-text
      max-height 4.8em !important // Override rules below.

  .invite-button-container
    padding 10px

  .members-title
    font-weight bold

  .users-list-component
    overflow auto // Scrollable.

  .room-members
    position relative
    overflow hidden

    transition-duration 0.2s
    transition-timing-function ease-out
    transition-property height

  .room-member
    position absolute
    width 100%

    transition-duration 0.2s
    transition-timing-function ease-out
    transition-property opacity, visibility, top

    &.hidden
      opacity 0
      visibility hidden

  .room-member-link
    display block
    box-sizing border-box
    width 100%
    padding 5px 10px
    color #000
    font-size 14px
    text-decoration none

    &:hover
      background-color #F8F8F8 !important

  .room-avatar
    float left
    margin-right 5px
    vertical-align middle

    width 26px
    height 26px
    border-width 3px

    &.avatars-off:not(.always-show-avatar), &.blank-avatar
      width 11px
      height 11px

    &.big-one-to-one-avatar
      // Center horizontally.
      display block
      float none
      margin 5px auto 0

      width room-members-sidebar-width - 30px
      height room-members-sidebar-width - 30px

  .room-member-info-cell
    margin-left 31px
    padding-top 1px
    text-shadow 0 1px 0 #fff

  .username
    display inline-block
    // Subtract the width of the avatar and margin.
    max-width room-members-sidebar-width - 50px - 5px
    overflow ellipsis
    line-height 1.2 // Since overflow is hidden, don't cut off descenders.

  .avatars-off
    .room-member-avatar-cell
      padding-top 1px
  
    .room-member-info-cell
      padding-top 0

  .admin-indicator, .status-text, .idle-duration
    box-sizing border-box
    max-height 2.4em
    overflow hidden
    color #A9A9A9
    font-size 12px

  .admin-indicator
    font-size 14px
    font-weight bold

    &.hidden
      display none

  .idle-duration
    white-space nowrap
    vertical-align 3px

    &.hidden
      display none

  .status-text
    white-space pre-wrap // Preserve whitespace.

.room-container
  position absolute
  top 0
  width 100%
  overflow hidden
  border-radius 6px

  &.has-active-room
    border 1px solid #C2C7CB

  .room-info
    position relative // For .room-actions-toggle.
    border-bottom 1px solid #C2C7CB
    padding 5px
    background-color #EEF0F0
    border-radius top 6px

  .room-avatar-permalink, .toggle-rooms-sidebar
    float left
    margin-right 5px

  .toggle-rooms-sidebar
    box-sizing border-box
    width 42px
    height 42px
    padding-top 11px
    padding-left 9px
    cursor pointer
    opacity .35

    &:hover
      opacity .8

  .edit-room-name-link, .edit-topic-link, .room-key-text
    color #aaa
    font-size 11px

  .edit-room-name-link, .edit-topic-link
    text-decoration none

    &:hover
      text-decoration underline

  .edit-room-name, .edit-topic
    width 70%

  .room-name-info-container, .topic-container
    box-sizing border-box
    padding 2px 5px 2px 0

  .room-name-info-container
    overflow ellipsis

  .room-permalink
    color #0F2035
    font-weight bold
    text-decoration none

    &:hover
      text-decoration underline

  .topic-cell
    // Set explicit height so that it doesn't change when editing topic.
    height 23px

  .topic-container
    // Leave space for avatar.  When editing, we can use percent width for text
    // input.
    margin-left 43px
    // Leave space for .room-actions-toggle.
    margin-right 37px
    // Remove top and bottom padding so we can use it for the text box which
    // takes up more vertical space.
    padding-top 0
    padding-bottom 0

    font-size 13px

  .edit-topic-form
    margin 0
    font-size 12px

  .topic-text
    padding-top 4px
    color #848894

  .room-actions-toggle
    // Center vertically.
    position absolute
    top 0
    bottom 0
    right 5px
    width 34px
    height 30px
    margin auto

    padding-top 4px
    padding-left 4px

    box-sizing border-box
    cursor pointer
    opacity .35

    &:hover
      opacity .7

  .room-settings-icon
    sprite-icon()
    width 24px
    height 21px
    sprites-background()
    background-position -5px -58px

.room-container-messages
  position relative

  .room-alert-banner
    position absolute
    z-index 1 // Show on top of .room-messages-view
    box-sizing border-box
    width 100%

    padding 20px
    background-color app-purple
    color #fff
    text-align center
    line-height 1.2

    .banner-title
      margin-bottom 10px

    .set-password-input
      margin-bottom 5px
      padding 8px
      font-size 14px
      vertical-align middle

    .app-btn
      vertical-align middle

    .close
      float right
      margin -15px -15px 5px 5px
      padding 5px 10px
      cursor pointer
      font-size 16px
      color rgba(255,255,255, .3)

      &:hover
        color #fff

    .action-link-container
      margin 20px 0 10px

  .room-alert-dialog
    position absolute
    z-index 1 // Show on top of .room-messages-view
    box-sizing border-box
    width 100%
    padding 20px
    text-align center

  .room-alert-content
    display inline-block
    margin 0 auto
    border-radius 6px
    padding 20px 30px
    background-color rgba(255,255,255, .9)

  .room-alert-message
    font-size 16px

  .members-preview-subtitle
    margin-top 15px
    margin-bottom 5px

  .join-button
    margin-top 15px

  .join-form
    margin-top 20px

    .join-button
      margin-top 0


room-join-dialog-width = 410px

.room-join-group-page-overlay
  // Make the background more visible than most overlays.
  background-color rgba(0,0,0, 0.1) // For browsers that don't support radial gradient.
  background radial-gradient(rgba(0,0,0,0) room-join-dialog-width, rgba(0,0,0, 0.4))

  // Show over the room, but under the app mobile install banner.
  z-index 99

  mobile-safari-fixed-position-fix()

.room-join-group-signup-form-component
  position absolute
  top 55px // Space for the banner.

  transition-duration .2s
  transition-timing-function ease-out
  transition-property left, top

  &.inline
    position static
    display inline-block // Shrink width to fit content.

.room-join-group-signup-form
  position relative
  margin 0
  z-index 100

  box-sizing border-box
  width room-join-dialog-width
  border 1px solid rgba(0,0,0, .28)
  border-radius 6px
  padding 30px
  background-clip padding-box
  background-color rgba(238, 240, 240, .96)
  box-shadow 0 0 30px rgba(0,0,0, .5)
  color rgb(0,0,0)
  text-align center
  line-height 1.2

  .room-header
    margin-bottom 10px

  .room-name
    margin-bottom 5px

  .title
    margin-bottom 8px
    font-size 19px
    line-height 1.2
    font-weight bold
    text-align center

  .subtitle
    margin-bottom 8px
    font-size 16px
    line-height 1.2
    text-align center

  input[type=text], input[type=password], input[type=email]
    box-sizing border-box
    width 100%
    padding-top 10px
    padding-bottom 10px
    text-align center

  .alert
    max-height 55px
    overflow hidden

    // Possibly displaying on top of member previews.
    box-shadow 0 0 30px rgba(0,0,0,.6)

    position relative
    top 5px
    opacity 0

    transition-duration 0.2s
    transition-timing-function ease-out
    transition-property opacity, top

    &.visible
      top 0
      opacity 1

    .close
      float right
      padding 0 8px
      cursor pointer

  .control-group
    line-height 1.2
    text-align left

  .control-label
    display inline-block
    margin-bottom 1px

  .related
    margin-top 3px
    font-size 12px
    text-align right

  .or-divider
    margin 10px
    text-align center

  .signup-with-facebook-button
    margin-bottom 0

  .login-hint
    margin-top 10px
    color rgba(0,0,0, 0.5)
    font-size 10px
    text-align center

  .terms
    margin-top 10px
    color rgba(0,0,0, 0.5)
    font-size 10px
    text-align center

    > a
      color rgba(0,0,0, 0.5)
      text-decoration none

      &:hover
        text-decoration underline

  .learn-more
    margin-top 15px
    font-size 14px
    text-align center


room-join-dialog-media-query = "(max-width: " + room-join-dialog-width + ")"
@media room-join-dialog-media-query
  .room-join-group-signup-form-component
    max-width 99% // Make sure we don't overflow the width.

  .room-join-group-signup-form
    max-width 100% // Make sure we don't overflow the width.
    padding 15px // Reduce the padding.

    .title
      margin-bottom 10px

    .or-divider
      margin 5px

.messages
  // Scrollable.
  overflow auto

  position absolute
  width 100%

  box-sizing border-box
  background-color #fff

  // When the user sets a custom wallpaper, stretch it keeping the aspect ratio.
  background-size cover

  transition-duration 0.1s
  transition-timing-function ease-out
  transition-property left, visibility

  &.inactive
    left 100%
    visibility hidden

    &.before-cursor
      left -100%

  // This class is set when the wallpaper preference is turned off.
  &.wallpaper-off
    background-image none !important

.loading-more-messages
  position absolute
  box-sizing border-box
  width 100px
  margin 0 auto
  padding 7px 10px
  background-color rgba(0,0,0, .05)
  border-radius bottom 6px
  font-size 12px
  text-align center

  transition opacity 0.1s ease-out, visibility 0.1s ease-out

  &.hidden
    opacity 0
    visibility hidden

sender-column-width = 150px

.message
  // border-top 1px solid #E1E1E1
  font-size 14px
  background-color rgba(255,255,255, 0.7)

  .message-table
    width 100%

  .sender-cell, .body-cell
    box-sizing border-box
    padding 5px
    vertical-align top

  .sender-cell
    float left
    width sender-column-width
    font-weight bold
    // border-top 1px solid #fff
    // border-right 1px solid #fff
    // background-color #F7F7F7
    text-align right

  .body-cell
    margin-left sender-column-width + 5px
    // border-left 1px solid #E1E1E1
    background-color rgba(255,255,255, 0.5)

  &.sent-by-you
    background-color hsla(191, 58%, 90%, 0.7)
    // border-color #BFD6EA

    .sender-cell
      // border-color #F3F7FB

    .body-cell
      // border-color #BFD6EA
      background-color hsla(191, 58%, 90%, 0.5)

  &.system-message

    .sender-cell
      border-right-color transparent
      // background-color #fff

    .body-cell
      border-left-color transparent
      background-color rgba(255,255,255, 0.2)
      color #777

  .sender, .message-body
    line-height 20px

  .sender
    display inline-block // Shrink to fit text.
    vertical-align middle
    cursor pointer // Clickable.

    // Truncate with ellipsis.
    box-sizing border-box
    max-width sender-column-width - 2 * 5px // Subtract 2 times the padding.
    overflow hidden
    white-space nowrap
    text-overflow ellipsis

    color #686868
    font-weight bold

  .expand-indicator
    position absolute
    top 5px
    left 5px
    border-radius 3px
    padding 8px 12px
    background-color rgba(0,0,0, .75)
    color #ddd
    cursor pointer
    opacity .8

    overflow hidden
    box-sizing border-box
    width 36px
    height 2*8px + 2*10px
    white-space nowrap

    transition width .1s ease-out

    > .play-icon
      display inline-block
      width 0
      height 0
      border 10px solid transparent
      border-left 15px solid #ddd
      border-right 0
      vertical-align middle

    > .play-text
      position relative
      top 2px
      padding-left 5px

    &.expanded
      width auto
      height auto
      left auto
      right 5px
      top 5px
      background-color rgba(0,0,0, .75)
      opacity .6
      // When it's expanded, only show it on mouse over.
      display none

  .video-attachment-preview
    position relative
    display inline-block
    // Min dimensions to have enough space for the .expand-indicator needed
    // when the preview image is super tiny or doesn't load.
    min-width 45px
    min-height 45px

    > img
      // Prevent space below the image.
      vertical-align middle

    &:hover
      .expand-indicator
        width 75px
        opacity 1

  .video-attachment
    position relative
    display inline-block

    &.not-displayed
      display none

    &:hover
      .expand-indicator
        display block
        opacity 1

  .video-attachment-video
    max-width 100%
    height auto

  .audio-attachment
    max-width 300px

  .download-link
    margin-top 3px

  .message-body
    overflow hidden
    white-space pre-wrap
    word-wrap break-word

  .mention
    display inline-block
    border 1px solid #C2C7CB
    border-radius 4px
    padding 0 3px

    color #000
    background-color #efefef

    &.you
      border-color #429C88
      color #fff
      background-color #27B99A

  .status
    min-width 48px // This is so it doesn't resize so much and reflow the text.
    float right
    margin 0 0 5px 10px
    color rgba(0,0,0, .25)
    font-size 10px
    text-align right

  .error
    color #b94a48

@media (max-width: 870px)

  .message

    // At narrow width, messages get the full width.
    .sender-cell
      float none
      padding-bottom 0
      text-align left
    .body-cell
      margin-left 0
    .status
      margin-top -19px
    .message-body
      width 100%

// This is used when adding the attachment.
@keyframes attachment-slide-in
  0%
    bottom -100px
  40%
    // Wait a bit without changing anything to wait for the file preview to
    // load.  Otherwise the image preview pops in mid-animation.
    bottom -100px
  60%
    bottom 70px
  80%
    bottom 55px
  100%
    bottom 60px

.attachment-thumbnail
  width 128px
  position absolute
  right 24px
  border 1px solid #BDC3C7
  border-radius 10px
  box-shadow 0 0 20px rgba(0,0,0, .5)
  padding 10px
  background-image linear-gradient(to bottom, #fff, #eee)
  font-size 12px
  text-align center

  bottom -100px
  visibility hidden

  // This is used when removing the attachment.
  transition-timing-function ease-out
  transition-duration .2s
  transition-property bottom, visibility

  &.has-attachment
    transition none // Turn off the other transition.
    animation-name attachment-slide-in
    animation-duration 1.1s
    animation-timing-function ease-in-out
    bottom 60px
    visibility visible

  .remove
    position absolute
    top 3px
    right 3px
    width 18px
    height 18px
    border-radius 50%
    border 1px solid rgba(128,128,128, .5)
    background-color #eee
    cursor pointer
    font-size 17px
    font-weight bold

    &:hover
      background-color #ccc

  .attachment-thumbnail-image
    height auto
    max-width 100%
    max-height 128px

  .filename
    width 100%
    overflow ellipsis

.connecting-status-bar
  position absolute
  right 10px
  bottom -48px // More than the height and box-shadow.
  box-sizing border-box
  width room-members-sidebar-width - 2 * 10px
  border 1px solid error-border-color
  border-top-left-radius 8px
  border-top-right-radius 8px
  box-shadow 0 0 20px rgba(0,0,0,0.33)
  padding 10px 35px
  background-color error-background-color
  color error-text-color
  opacity 0.95
  text-align center

  transition bottom 0.3s ease-out

  &.hidden
    display none

  &.offline
    bottom 0

.send-message-area
  position absolute
  bottom 0
  box-sizing border-box
  height 52px
  padding 5px
  border-top 1px solid #C2C7CB
  border-bottom-left-radius 6px
  background-color #EEF0F0

  &.hidden
    display none

  .send-message-text
    box-sizing border-box
    width 300px
    height 40px
    border 1px solid #BDC2C7
    border-radius 6px
    padding 4px 63px 4px 8px
    font-size 12px
    resize none

    &:focus
      outline 0

  .send-message-file
    display none

  .message-emoticon-icon
    sprites-background()
    sprite-icon()
    width 24px
    height 24px
    background-position -142px -6px

    position absolute
    top 13px

    cursor pointer

  .message-attach-icon
    sprites-background()
    sprite-icon()
    width 24px
    height 24px
    background-position -173px -6px

    position absolute
    top 13px

    cursor pointer

  .send-button
    position absolute
    top 5px
    right 5px
    margin 0
    border 1px solid rgba(0, 0, 20, 0.3)
    padding 10px 17px
    border-radius 6px
    background-color #EEF0F0
    box-shadow inset 0 0 1px rgba(255,255,255, 0.9)
    color #8E929E
    font-size 14px

    &:hover
      background-color lighten(#EEF0F0, 50%)

    &.encrypted-send-button
      background-color app-green
      color #fff

      &:hover
        background-color lighten(app-green, 10%)

      &:after
        content " Encrypted"

    &:active
      outline 0
      box-shadow inset 0 0 8px rgba(0,0,0, 0.5)

// At this width, we do not show the .room-members-sidebar
@media (max-width: 700px)
  .send-message-area
    border-bottom-right-radius 6px

.autocomplete
  position absolute
  left 10px
  bottom 54px
  border-radius 6px
  box-shadow 0 0 5px rgba(0,0,0, .2)
  background-color #fff
  overflow hidden
  opacity 0.95

  transition opacity 0.1s ease-in, visibility 0.1s ease-in

  &.hidden
    opacity 0
    visibility hidden

.autocomplete-item
  padding 2px 10px
  cursor pointer

  &.all-item
    padding-left 23px

  &.active
    background-color #417ACE
    color #f0f0f0

  .room-avatar.blank-avatar
    margin-top -2px
