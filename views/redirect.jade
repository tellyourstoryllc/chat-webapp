extends mobile-layout

block content
  script.
    // Skip tracking the default initial page view.
    window.dontTrackPageView = true;
  div(style='text-align: center; margin-bottom: 10px')
    img(src=img('/images/' + config.appStaticViewsDirectory + 'logo-wide.png') alt=config.displayTitle style='width: 100px; height: auto;')
  p(style='text-align: center')
    | Redirecting...

//- Make sure this goes after loading config.
block foot-content
  != js('mobile-utils')
  script.
    var redirectToRightPlace = function() {
      var url = !{JSON.stringify(url)};
      MobileUtils.redirect(url);
    };

    if (typeof ga !== 'undefined' && ga !== null) {
      ga(function() {
        var url = MobileUtils.stripAppTokensFromUrl(window.location.pathname);
        // Wait for Google Analytics to load and the page view to get tracked.
        ga('send', 'pageview', url, {
          hitCallback: redirectToRightPlace
        });
      });
      // Give up on Google Anayltics after a while.
      window.setTimeout(redirectToRightPlace, 2000);
    }
    else {
      redirectToRightPlace();
    }
